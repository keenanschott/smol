<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode | default "en-us" }}">

<head>
  <meta charset="UTF-8" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  <!-- Page Metadata -->
  {{ if (eq .Title .Site.Title) }}
    <title>{{ .Title }}</title>
  {{ else }}
    {{ with $title := printf "%s - %s" .Title .Site.Title }}
      <title>{{ . }}</title>
    {{ end }}
  {{ end }}
  <meta name="description" content="{{ with .Description }}{{ . }}{{ else }}{{if .IsPage}}{{ .Summary }}{{ else }}{{ with .Site.Params.description }}{{ . }}{{ end }}{{ end }}{{ end }}" />
  {{ with .Site.Params.author }}
    <meta name="author" content="{{ . }}" />
  {{ end }}
  {{ if .Params.image }}
    <meta property="og:image" content="{{ .Site.BaseURL }}/{{ path.Join .File.Dir .Params.image }}" />
  {{ else }}
    {{ if .Site.Params.logo }}
      <meta property="og:image" content="{{ .Site.BaseURL }}/{{ .Site.Params.logo }}">
    {{ end }}
  {{ end }}
  {{ template "_internal/opengraph.html" . }}
  {{ template "_internal/twitter_cards.html" . }}

  <!-- CSS -->
  <!-- Always make sure to force monospace, even if the style hasn't been loaded yet. -->
  <style type="text/css">
    body {
      font-family: Iosevka, monospace;
    }
  </style>

  <!-- Load the main stylesheet. -->
  {{ $options := (dict "targetPath" "style.css" "outputStyle" "compact" "enableSourceMap" true ) }}
  {{ $style := resources.Get "scss/main.scss" | resources.ToCSS $options }}
  <link
    rel="stylesheet"
    href="{{ $style.Permalink }}?cb={{ now.Unix }}"
    integrity="{{ $style.Data.Integrity }}" />

  <!-- Load custom CSS. -->
  {{ range .Site.Params.customCSS -}}
    <link rel="stylesheet" href="{{ . | relURL }}?rnd={{ now.Unix }}" />
  {{- end }}

  <!-- RSS -->
  {{ with .OutputFormats.Get "RSS" -}}
    {{ printf `<link rel="%s" type="%s" href="%s" title="%s" />` .Rel .MediaType.Type .RelPermalink $.Site.Title | safeHTML }}
  {{- end }}

  {{- with .Site.Params.plausible -}}
    {{ printf `<script defer data-domain="%s" src="%s/js/script.js"></script>` .domain .plausibleRoot | safeHTML }}
  {{- end -}}

  {{- with .Site.Params.goatcounter -}}
    {{ printf `<script data-goatcounter="%s" async src="//gc.zgo.at/count.js"></script>` .domain | safeHTML }}
  {{- end -}}
</head>

<body>
  {{ partial "header" . }}
  {{ block "main" . }}{{ end }}
  {{ partial "footer" . }}
</body>

</html>
